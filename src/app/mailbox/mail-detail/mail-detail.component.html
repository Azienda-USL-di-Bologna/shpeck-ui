<div class="detail-container">
  <h3 class="mail-object">{{eml?.subject}}</h3>
  <p-accordion [multiple]="true" class="multi-accordion-eml-detail">
      <p-accordionTab header="Dettagli" class="accordion-dettagli"
        [disabled]="eml == null">
        <span *ngIf="eml?.sendDate" class="send-date">{{getDateDisplay(eml.sendDate)}}</span>
        <ul class="elenco-dettagli">
            <!-- <li *ngIf="eml?.ricevuta"><span class="li-description">Ricevuta il:</span><span class="li-content">{{eml?.ricevuta}}</span></li>
            <li *ngIf="eml?.consegnata"><span class="li-description">Consegnata il:</span><span class="li-content">{{eml?.consegnata}}</span></li> -->
            <!-- <li *ngIf="eml?.sendDate"><span class="li-description">Inviato:</span><span class="li-content">{{getDateDisplay(eml.sendDate)}}</span></li> -->
            <li *ngIf="eml?.from"><span class="li-description">Da:</span><span class="li-content indirizzo">{{eml?.from}}</span></li>
            <li *ngIf="eml?.to && eml?.to.length > 0">
              <span class="li-description">A:</span>
              <span *ngFor="let t of eml?.to" class="li-content indirizzo">{{t}}</span>
            </li>
            <li *ngIf="eml?.cc && eml?.cc.length > 0">
              <span class="li-description">CC:</span>
              <span *ngFor="let c of eml?.cc" class="li-content indirizzo">{{c}}</span>
            </li>
        </ul>
      </p-accordionTab>
      <p-accordionTab header="Allegati" [disabled]="eml?.attachments == null" class="accordion-allegati">
        <div class="box-allegati">
          <div *ngFor="let attachment of eml?.attachments">
            <span *ngIf="!attachment.forHtmlAttribute" class="allegato">
              <i class="fa icona" [ngClass]="getFaClass(attachment)"></i>
              <span 
                class="allegato-nome" 
                [pTooltip]="attachment.fileName"
                tooltipPosition="top"
                tooltipStyleClass="tooltip"
                (click)="getEmlAttachment(attachment, true)">
                {{attachment.displayName}}
              </span>
              <span class="allegato-size">({{getSizeString(attachment.size)}})</span>
              <span class="allegato-scarica" (click)="getEmlAttachment(attachment)">Scarica</span>
            </span>
          </div>
        </div>
        <i class="fa fa-file-zip-o icona scarica-tutti-icon"></i>
        <span *ngIf="eml?.attachments" class="scarica-tutti" (click)="getAllEmlAttachment()">Scarica tutti gli allegati</span>
      </p-accordionTab>
  </p-accordion>
  <div class="mail-body-box" [ngClass]="{'mail-body-box-no-anteprima' : !eml?.displayBody}">
    <iframe
      #emliframe 
      *ngIf="eml?.displayBody" 
      [srcdoc]="eml?.displayBody | sanitizeHtml" 
      class="mail-body" 
      (load)="customizeIframeContent()"
      frameborder="0"
      sandbox="allow-popups allow-popups-to-escape-sandbox allow-same-origin">
    </iframe>
    <div *ngIf="!eml?.displayBody" class="no-anteprima">Anteprima non disponibile.</div>
  </div>
</div>
