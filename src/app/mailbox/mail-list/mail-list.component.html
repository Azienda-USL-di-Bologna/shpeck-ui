<!-- 
       [lazy]="true" (onLazyLoad)="lazyLoad($event)"
    [value]="messages"
    [columns]="cols"
    [paginator]="false"
    [autoLayout]="false"
    [responsive]="true"
    [totalRecords]="totalRecords"
    selectionMode="multiple"
    [metaKeySelection]="true"
    [scrollable]="true" [virtualRowHeight]="10" [virtualScroll]="true"
    (onRowSelect)="handleEvent('onRowSelect', $event)" 
-->
<!-- <p-table #dt
    [lazy]="true"
    [value]="messages"
    [columns]="cols"
    [paginator]="false"
    [autoLayout]="false"
    [responsive]="true"
    [totalRecords]="totalRecords"
    selectionMode="multiple"
    [metaKeySelection]="true"
    [scrollable]="false"
    (onRowSelect)="handleEvent('onRowSelect', $event)"
    
    [rowTrackBy]="trackByFn"
    > -->

<p-table #dt *ngIf="_folder"
    [lazy]="true" (onLazyLoad)="lazyLoad($event)"
    scrollHeight="100%"
    [value]="messages"
    [columns]="cols"
    [paginator]="false"
    [loading]="loading"
    [autoLayout]="true"
    [responsive]="true"
    [totalRecords]="totalRecords"
    [(selection)]="selectedMessages"
    contextMenuSelectionMode="joint"
    selectionMode="multiple"
    [metaKeySelection]="true"
    [lazyLoadOnInit] = "true"
    [rows]="rowsNmber"
    [rowTrackBy]="trackByFn"
    [contextMenu]="cm"
    [scrollable]="true" [virtualRowHeight]="virtualRowHeight" [virtualScroll]="true" [virtualScrollDelay]="150"
    (onRowSelect)="handleEvent('onRowSelect', $event)" (onRowUnselect)="handleEvent('onRowUnselect', $event)"
    (selectionChange)="handleEvent('selectionChange', $event)"
    (onContextMenuSelect)="handleEvent('onContextMenuSelect', $event)"
    >
    <ng-template pTemplate="body" let-rowData let-message let-rowIndex="rowIndex">
        <tr #selRow class="message-row" [pSelectableRow]="rowData" [pSelectableRowIndex]="rowIndex" [pContextMenuRow]="rowData" >
            <td>
                <div class = "mail-icons-container">
                    <span *ngIf="message['iconsVisibility']['replied'] || message['iconsVisibility']['replied_all']">
                        <span class="mail-icon" [ngClass]="{'visibility-hidden':!message['iconsVisibility']['replied_all'] && !message['iconsVisibility']['replied']}">
                            <i [pTooltip]="getTagDescription('replied_all')" tooltipPosition="top" *ngIf="message['iconsVisibility']['replied_all']; else reply_single" class="material-icons mail-icons">reply_all</i>
                            <ng-template #reply_single><i [pTooltip]="getTagDescription('replied')" tooltipPosition="top" class="material-icons mail-icons">reply</i></ng-template>
                        </span>
                    </span>
                    <span *ngIf="!message['iconsVisibility']['replied'] && !message['iconsVisibility']['replied_all']" class="mail-icon visibility-hidden"><i class="material-icons mail-icons">reply_all</i></span>
                    <span class="mail-icon" [ngClass]="{'visibility-hidden':!message['iconsVisibility']['forwarded']}"><i [pTooltip]="getTagDescription('forwarded')" tooltipPosition="top" class="material-icons mail-icons">forward</i></span>
                    <span class="mail-icon" [ngClass]="{'visibility-hidden':!message['iconsVisibility']['assigned']}"><i [pTooltip]="getTagDescription('assigned')" tooltipPosition="top" class="material-icons mail-icons">merge_type</i></span>
                    <span class="mail-icon" [ngClass]="{'visibility-hidden':!message['iconsVisibility']['readdressed']}"><i [pTooltip]="getTagDescription('readdressed')" tooltipPosition="top" class="material-icons mail-icons">fast_forward</i></span>
                </div>
                <div class = "display-block">
                    <span class = "pi pi-user display-icon"></span> <div class="display-text" [ngClass]="{'display-bold':!message.seen}">{{message.fromOrTo}}</div> 
                </div>
                <div class = "display-block extra-margin">
                    <span *ngIf="!message.seen" class="fa fa-envelope display-icon envelope-icon"></span>
                    <span *ngIf="message.seen" class="fa fa-envelope-open-o display-icon envelope-icon"></span>
                    <div class="display-text" [ngClass]="{'display-bold':!message.seen}">{{message.id + " -- " + message.subject}}</div> 
                </div>
            </td>
        </tr>
    </ng-template>
    <!-- <ng-template pTemplate="loadingbody" let-columns="columns">
        <tr style="height:68px">
            <td *ngFor="let col of columns">
                <div class="loading-text"></div>
            </td>
        </tr>
    </ng-template> -->

</p-table>

<p-contextMenu #cm [model]="cmItems" styleClass = "context-menu"></p-contextMenu>
<!-- "{'margin': '-128px 0 0 -312px'}" -->
