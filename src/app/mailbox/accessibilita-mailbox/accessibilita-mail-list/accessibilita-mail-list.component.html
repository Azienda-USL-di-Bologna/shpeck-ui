<p-table #dt 
  tabindex="0"
  *ngIf="mostratable && (_selectedTag || _selectedFolder || _filters)"
  [value]="mailListService.messages"
  (onLazyLoad)="lazyLoad($event)"
  
  [lazy]="true" 
  [totalRecords]="mailListService.totalRecords"
  dataKey="id"
  selectionMode="single"
  [lazyLoadOnInit]="true"
  [loading]="loading"
  [paginator]="true" 
  [rows]="rowsNmber" 
  [showCurrentPageReport]="true" 
  [metaKeySelection]="true"
  [(first)]="first"
  [rowTrackBy]="trackByFn"
  [scrollable]="true"
  scrollHeight="100%"
  currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" 
  [rowsPerPageOptions]="[10,25,50]">
  <!-- [(selection)]="mailListService.selectedMessages" 
  (onRowUnselect)="handleEvent('onRowUnselect', $event)" -->
  <ng-template pTemplate="header">
    <tr>
      <th *ngIf="_selectedFolder !== null && (_selectedFolder.type === folderTypeSent || _selectedFolder.type === folderTypeOutbox)">A</th>
      <th *ngIf="_selectedFolder !== null && _selectedFolder.type === folderTypeInbox">Da</th>
      <th *ngIf="_selectedTag !== null || (_selectedFolder !== null &&( _selectedFolder.type !== folderTypeSent && _selectedFolder.type !== folderTypeOutbox && _selectedFolder.type !== folderTypeInbox)) ">Da/A</th>
      <th>Oggetto</th>
      <th>Data</th>
    </tr>
  </ng-template>
  <ng-template pTemplate="body" let-message> 
    <tr #selRow
      [attr.name]="message.id"
      
      ><!-- [pSelectableRow]="message" (keydown.enter)="vaiAlDettaglio($event, message, message)" -->

      <td> <div *ngFor="let element of buildAddressColumn(message,_selectedTag !== null || _selectedFolder !== null && _selectedFolder.type !== folderTypeInbox)">
        {{element}}
      </div>
      </td>
      <td><a (click)="vaiAlDettaglio($event, message, message)" style="font-weight: bold; cursor: pointer;">{{message.subject}}</a></td>
      <td>{{message.receiveTime | date:'dd/MM/yyyy hh:mm'}}</td>
    </tr>
  </ng-template>
</p-table>


<p-dialog *ngIf="displayDetailPopup" [(visible)]="displayDetailPopup" class="popup-mail-detail">
  <p-header>
    Dettaglio
  </p-header>
  <p-footer>
    <button 
      type="button" 
      pButton 
      (click)="displayDetailPopup = false" 
      label="Chiudi"
      class="ui-button-raised ui-button-secondary button-styles custom-secondary-button">
    </button>
  </p-footer>
</p-dialog>